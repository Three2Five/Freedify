<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Freedify</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/static/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/static/icon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <!-- Google API for Drive sync -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
</head>
<body>
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>
    
    <!-- Keyboard Shortcuts Help -->
    <div id="shortcuts-help" class="shortcuts-help hidden">
        <div class="shortcuts-content">
            <div class="shortcuts-header">
                <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                <button id="shortcuts-close" class="shortcuts-close">√ó</button>
            </div>
            <div class="shortcuts-grid">
                <div class="shortcut"><kbd>Space</kbd><span>Play/Pause</span></div>
                <div class="shortcut"><kbd>‚Üí</kbd><span>Next Track</span></div>
                <div class="shortcut"><kbd>‚Üê</kbd><span>Previous Track</span></div>
                <div class="shortcut"><kbd>Shift + ‚Üí</kbd><span>Seek +10s</span></div>
                <div class="shortcut"><kbd>Shift + ‚Üê</kbd><span>Seek -10s</span></div>
                <div class="shortcut"><kbd>‚Üë</kbd><span>Volume Up</span></div>
                <div class="shortcut"><kbd>‚Üì</kbd><span>Volume Down</span></div>
                <div class="shortcut"><kbd>M</kbd><span>Mute/Unmute</span></div>
                <div class="shortcut"><kbd>S</kbd><span>Shuffle Queue</span></div>
                <div class="shortcut"><kbd>R</kbd><span>Toggle Repeat</span></div>
                <div class="shortcut"><kbd>F</kbd><span>Fullscreen</span></div>
                <div class="shortcut"><kbd>Q</kbd><span>Toggle Queue</span></div>
                <div class="shortcut"><kbd>?</kbd><span>This Help</span></div>
            </div>
        </div>
    </div>

    <div class="app">
        <!-- Header -->
        <header class="header">
            <h1 class="logo">üéµ Freedify</h1>
            <div class="header-actions">
                <button id="sync-btn" class="header-btn" title="Sync with Google Drive">‚òÅÔ∏è</button>
                <button id="theme-btn" class="theme-btn" title="Change Theme">üé®</button>
            </div>
        </header>
        
        <!-- Theme Picker Dropdown -->
        <div id="theme-picker" class="theme-picker hidden">
            <div class="theme-option" data-theme="">üåô Default</div>
            <div class="theme-option" data-theme="theme-purple">üíú Purple</div>
            <div class="theme-option" data-theme="theme-blue">üíô Blue</div>
            <div class="theme-option" data-theme="theme-green">üíö Green</div>
            <div class="theme-option" data-theme="theme-pink">üíï Pink</div>
            <div class="theme-option" data-theme="theme-orange">üß° Orange</div>
        </div>

        <!-- Search Section -->
        <section class="search-section">
            <div class="search-container">
                <input 
                    type="text" 
                    id="search-input" 
                    class="search-input"
                    placeholder="Search music or paste ANY link (Spotify, Bandcamp, SoundCloud...)"
                    autocomplete="off"
                    title="Search or Import"
                >
                <button id="search-clear" class="search-clear" title="Clear search">√ó</button>
            </div>
            
            <!-- Search Type Selector -->
            <div class="search-type-selector">
                <button class="type-btn active" data-type="track">Songs</button>
                <button class="type-btn" data-type="album">Albums</button>
                <button class="type-btn" data-type="artist">Artists</button>
                <button class="type-btn" data-type="podcast">Podcasts</button>
                <button class="type-btn favorites-btn" data-type="favorites">‚ù§Ô∏è Favorites</button>
            </div>
        </section>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="loading-content">
                <div class="spinner"></div>
                <p id="loading-text">Loading...</p>
            </div>
        </div>

        <!-- Error Message -->
        <div id="error-message" class="error-message hidden">
            <span class="error-icon">üòï</span>
            <p id="error-text">Something went wrong</p>
            <button id="error-retry" class="btn-retry">Try Again</button>
        </div>

        <!-- Download Modal -->
        <div id="download-modal" class="modal hidden">
            <div class="modal-content">
                <h3>Download Track</h3>
                <p id="download-track-name">Track Name</p>
                
                <div class="format-selector">
                    <label>Select Format:</label>
                    <select id="download-format">
                        <option value="mp3">MP3 (320kbps)</option>
                        <option value="flac">FLAC (Lossless)</option>
                        <option value="aiff">AIFF (DJ Friendly)</option>
                        <option value="wav">WAV (Lossless)</option>
                        <option value="alac">ALAC (Apple Lossless)</option>
                    </select>
                </div>
                
                <div class="modal-actions">
                    <button id="download-cancel-btn" class="btn-secondary">Cancel</button>
                    <button id="download-confirm-btn" class="btn-primary">Download</button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <section id="results-section" class="results-section">
            <div id="results-container" class="results-container">
                <!-- Search results will be inserted here -->
                <div class="empty-state">
                    <span class="empty-icon">üîç</span>
                    <p>Search for your favorite music</p>
                    <p class="hint">Or paste a Spotify link to an album or playlist</p>
                </div>
            </div>
        </section>

        <!-- Album/Playlist Detail View -->
        <section id="detail-view" class="detail-view hidden">
            <div class="detail-header">
                <button id="back-btn" class="back-btn">‚Üê Back</button>
                <div class="detail-actions">
                    <button id="shuffle-btn" class="shuffle-btn" title="Shuffle & Play">üîÄ Shuffle</button>
                    <button id="queue-all-btn" class="queue-all-btn">Add All to Queue</button>
                    <button id="download-all-btn" class="download-all-btn">Download ZIP</button>
                </div>
            </div>
            <div id="detail-info" class="detail-info">
                <!-- Album/playlist info will be inserted here -->
            </div>
            <div id="detail-tracks" class="detail-tracks">
                <!-- Tracks will be inserted here -->
            </div>
        </section>

        <!-- Queue Section -->
        <section id="queue-section" class="queue-section hidden">
            <div class="queue-header">
                <h3>Queue <span id="queue-count">(0)</span></h3>
                <div class="queue-controls">
                    <button id="queue-clear" class="queue-clear">Clear</button>
                    <button id="queue-close" class="queue-close-btn" title="Close Queue">√ó</button>
                </div>
            </div>
            <div id="queue-container" class="queue-container">
                <!-- Queue items will be inserted here -->
            </div>
        </section>

        <!-- Bottom Player -->
        <div id="player-bar" class="player-bar hidden">
            <div class="player-info">
                <img id="player-art" class="player-art" src="" alt="Album art">
                <div class="player-details">
                    <p id="player-title" class="player-title">No track playing</p>
                    <p id="player-artist" class="player-artist">-</p>
                </div>
            </div>
            
            <div class="player-controls">
                <button id="shuffle-queue-btn" class="control-btn" title="Shuffle Queue">‚§≠</button>
                <button id="repeat-btn" class="control-btn" title="Repeat: Off">‚ü≥</button>
                <button id="prev-btn" class="control-btn" title="Previous">‚èÆ</button>
                <button id="play-btn" class="control-btn play-btn" title="Play/Pause">‚ñ∂</button>
                <button id="next-btn" class="control-btn" title="Next">‚è≠</button>
                <button id="download-current-btn" class="control-btn" title="Download Current Track">‚¨á</button>
                <button id="queue-btn" class="control-btn queue-toggle" title="Toggle Queue">‚ò∞</button>
                <button id="fs-toggle-btn" class="control-btn" title="Full Screen">‚§¢</button>
            </div>
            
            <div class="player-progress">
                <span id="current-time" class="time">0:00</span>
                <input type="range" id="progress-bar" class="progress-bar" min="0" max="100" value="0" title="Seek">
                <span id="duration" class="time">0:00</span>
            </div>
            
            <div class="volume-controls">
                <button id="mute-btn" class="control-btn volume-btn" title="Mute">üîä</button>
                <input type="range" id="volume-slider" class="volume-slider" min="0" max="100" value="100" title="Volume">
                <button id="eq-toggle-btn" class="control-btn eq-btn" title="Equalizer">üéõÔ∏è</button>
            </div>
        </div>

        <!-- Equalizer Panel -->
        <div id="eq-panel" class="eq-panel hidden">
            <div class="eq-header">
                <h3>üéõÔ∏è Equalizer</h3>
                <button id="eq-close-btn" class="eq-close-btn">√ó</button>
            </div>
            
            <div class="eq-presets">
                <button class="eq-preset active" data-preset="flat">Flat</button>
                <button class="eq-preset" data-preset="bass">Bass Boost</button>
                <button class="eq-preset" data-preset="treble">Treble</button>
                <button class="eq-preset" data-preset="vocal">Vocal</button>
            </div>
            
            <div class="eq-sliders">
                <div class="eq-band">
                    <input type="range" id="eq-60" class="eq-slider" min="-12" max="12" value="0" orient="vertical">
                    <span class="eq-label">60Hz</span>
                </div>
                <div class="eq-band">
                    <input type="range" id="eq-230" class="eq-slider" min="-12" max="12" value="0" orient="vertical">
                    <span class="eq-label">230Hz</span>
                </div>
                <div class="eq-band">
                    <input type="range" id="eq-910" class="eq-slider" min="-12" max="12" value="0" orient="vertical">
                    <span class="eq-label">910Hz</span>
                </div>
                <div class="eq-band">
                    <input type="range" id="eq-3600" class="eq-slider" min="-12" max="12" value="0" orient="vertical">
                    <span class="eq-label">3.6kHz</span>
                </div>
                <div class="eq-band">
                    <input type="range" id="eq-14000" class="eq-slider" min="-12" max="12" value="0" orient="vertical">
                    <span class="eq-label">14kHz</span>
                </div>
            </div>
            
            <div class="eq-extras">
                <div class="eq-extra">
                    <label for="bass-boost">Bass Boost</label>
                    <input type="range" id="bass-boost" class="eq-boost-slider" min="0" max="12" value="0">
                    <span id="bass-boost-val">0dB</span>
                </div>
                <div class="eq-extra">
                    <label for="volume-boost">Volume Boost</label>
                    <input type="range" id="volume-boost" class="eq-boost-slider" min="0" max="6" value="0">
                    <span id="volume-boost-val">0dB</span>
                </div>
            </div>
        </div>

        <!-- Audio Element -->
        <audio id="audio-player" preload="auto"></audio>
    </div>

    <!-- Fullscreen Player Overlay (outside .app for proper fixed positioning) -->
    <div id="fullscreen-player" class="fullscreen-player hidden">
        <div class="fs-backdrop"></div>
        <div class="fs-content">
            <div class="fs-header">
                 <button id="fs-close-btn" class="fs-close-btn">√ó</button>
            </div>
            <div class="fs-art-container">
                <img id="fs-art" src="/static/icon.svg" alt="Album Art">
            </div>
            <div class="fs-info">
                <h2 id="fs-title">No Track Playing</h2>
                <p id="fs-artist">Select music to play</p>
            </div>
            <div class="fs-progress-container">
                <span id="fs-current-time">0:00</span>
                <input type="range" id="fs-progress-bar" class="progress-bar" min="0" max="100" value="0" title="Seek">
                <span id="fs-duration">0:00</span>
            </div>
            <div class="fs-controls">
                <button id="fs-prev-btn" class="fs-control-btn">‚èÆ</button>
                <button id="fs-play-btn" class="fs-control-btn play-btn">‚ñ∂</button>
                <button id="fs-next-btn" class="fs-control-btn">‚è≠</button>
                <button id="fs-download-btn" class="fs-control-btn" title="Download">‚¨á</button>
            </div>
        </div>
    </div>

    <!-- Podcast Episode Details Modal -->
    <div id="podcast-modal" class="podcast-modal hidden">
        <div class="podcast-modal-content">
            <button id="podcast-modal-close" class="podcast-modal-close">√ó</button>
            <img id="podcast-modal-art" class="podcast-modal-art" src="" alt="Episode Art">
            <h2 id="podcast-modal-title" class="podcast-modal-title"></h2>
            <p id="podcast-modal-date" class="podcast-modal-date"></p>
            <p id="podcast-modal-duration" class="podcast-modal-duration"></p>
            <div id="podcast-modal-description" class="podcast-modal-description"></div>
            <div class="podcast-modal-actions">
                <button id="podcast-modal-play" class="podcast-modal-play">‚ñ∂ Play Episode</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
